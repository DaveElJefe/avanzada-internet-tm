<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas</title>
    <style type="text/css">
        canvas{
            background-color: rgb(152, 187, 230);
        }
    </style>
</head>
<body>
    <canvas id="mainCanvas" width="500" height="500"></canvas>
    
    <script type="text/javascript">
        var cv = null;
        var ctx = null;
        var posX = 0;
        var posY = 0;
        var player1 = null;
        
        window.requestAnimationFrame = (function () {
        return window.requestAnimationFrame ||
            window.webkitRequestAnimationFrame ||
            window.mozRequestAnimationFrame ||
            function (callback) {
                window.setTimeout(callback, 17);
            };
        }());

        window.addEventListener('load',run,false);

        function run(){
            cv = document.getElementById('mainCanvas');
            ctx = cv.getContext('2d');
            player1 = new Cuadro(posX,posY,30,30,'lightgreen');
            paint();
        }

        function Cuadro(x,y,width,height,color){
            this.x = x;
            this.y = y;
            this.width = width;
            this.height = height;
            this.color = color;

            this.pintar = function(ctx){
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x,this.y,this.width,this.height);
            }

            this.intersects = function (target) { 
                if(this.x < target.x + target.width && 
                    this.x + this.width > target.x && 
                    this.y < target.y + target.height && 
                    this.y + this.height > target.y){
                    return true;
                }
            };
        }

        function paint(){
            window.requestAnimationFrame(paint);
            
            paintBg(player1.x,player1.y);
            player1.pintar(ctx);
        }

        function paintBg(x,y){
            ctx.fillStyle = "rgb(152, 187, 230)";
            ctx.fillRect(x,y,30,30);
        }

        document.addEventListener('keydown',function(e){
            paintBg(player1.x,player1.y);
            if(e.code=="ArrowUp" || e.code=="KeyW"){
                player1.y -= 10;
                if(player1.y<0){
                    player1.y = 0;
                }
            }
            if(e.code=="ArrowDown" || e.code=="KeyS"){
                player1.y += 10;
                if(player1.y>470){
                    player1.y = 470;
                }
            }
            if(e.code=="ArrowLeft" || e.code=="KeyA"){
                player1.x -= 10;
                if(player1.x<0){
                    player1.x = 0;
                }
            }
            if(e.code=="ArrowRight" || e.code=="KeyD"){
                player1.x += 10;
                if(player1.x>470){
                    player1.x = 470;
                }
            }
            paint();
        })

        function generateRandomColor() {
            var alpha = '0.5';
            var color = 'rgba(';
            for (var i = 0; i < 3; i++) {
                color += Math.floor(Math.random() * 255) + ',';
            }
            color += alpha + ')';
            return color;
        }
    </script>
</body>
</html>